<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">


    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <title>Answers</title>
</head>
<body>
{% extends "base.html" %}
{% block content %}


<div class="container"  ng-app="answerCheckingModule" ng-controller ="answerCheckingController as vm">
     <div class="alert alert-info" role="alert" ng-show="{{message}}">
        {{message}}
    </div>
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close" ng-click="vm.closeModal()" >&times;</span>
            <div>
                <label class="filter-label">Team:</label>
                <select class="filter-dropdown" ng-model="filteredTeam">
                    <option ng-value="">Alle teams</option>
                    <option ng-repeat="team in vm.teams">//team.teamname//</option>
                </select>
            </div>
            <div>
                <label class="filter-label">Categorie:</label>
                <select class="filter-dropdown" ng-model="filteredCategory">
                    <option ng-value="">Alle Categorieen</option>
                    <option ng-repeat="category in vm.categories">//category.name//</option>
                </select>
            </div>
            <div>
                <label class="filter-label">Vraag:</label>
                <select class="filter-dropdown" ng-model="filteredQuestion">
                    <option ng-value="">Alle vragen</option>
                    <option ng-repeat="question in vm.questions" ng-value="question">//question.questionnumber// //question.question//</option>
                </select>
            </div>
            <div>
                <label class="filter-label">Correct:</label>
                <select class="filter-dropdown" ng-model="correctfilter">
                    <option ng-value=''>Alles</option>
                    <option ng-value=true>Ja</option>
                    <option ng-value=false>Nee</option>
                </select>
            </div>
            <div>
                <label class="filter-label">Laatst nagekeken door:</label>
                <select class="filter-dropdown" ng-model = "checkedbyfilter">
                    <option ng-value="">Iedereen</option>
                    <option ng-repeat="person in vm.persons">//person.personname//</option>
                </select>
            </div>
            <div>
                <label class="filter-label">Zekerheid:</label>
                <span class="valuePadding input-holder"><input placeholder="Van" type="number"  ng-model="confidencefrom" style="text-align:left;"></span>
                <span class="valuePadding input-holder"><input placeholder="Tot" type="number"  ng-model="confidenceto" style="text-align:left;"></span>
            </div>
            <div>
                <button class="btn btn-primary" ng-click="vm.closeModal(); currentPage=0">Opslaan</button>
            </div>
        </div>
    </div>
    <button class = 'btn btn-primary' id="myBtn" ng-click="vm.showModal()">Filter</button>
    <div class = "vm.checkinganswers" ng-hide="vm.checkinganswers">
        <table class="table table-hover table-sm table-fixed">
            <thead class="header">
                <tr>
                    <th scope="col" ng-click="vm.sortBy('answered_by.teamname')">Team</th>
                    <th scope="col" ng-click="vm.sortBy('question.questionnumber')">Vraag</th>
                    <th scope="col">Correct Antwoord</th>
                    <th scope="col">Gegeven Antwoord</th>
                    <th scope="col" style="width:300px;">Afbeelding</th>
                    <th scope="col" style="width:60px;">Correct</th>
                    <th scope="col" style="width:100px;">Zekerheid systeem</th>
                    <th scope="col" ng-click = "vm.sortBy('checkedby.personname')">Laatst nagekeken door</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="answergiven in vm.filteredanswers = (vm.answers | orderBy:vm.propertyName:vm.reverse | byCategory:filteredCategory | byTeam:filteredTeam | byQuestion:filteredQuestion | bySubanswers:confidencefrom:confidenceto:correctfilter:checkedbyfilter)  | startFrom:currentPage*vm.pageSize | limitTo:vm.pageSize">

                    <td>//answergiven.answered_by.teamname//</td>
                    <td><b>//answergiven.question.questionnumber//</b> //answergiven.question.question//</td>
                    <td>
                        <div id = 'subanswerintable'>
                            <table class="table table-borderless">
                                <tbody>
                                    <tr ng-repeat="subanswer in answergiven.question.subanswers">
                                        <td ng-repeat="variant in subanswer.variants">//variant.answer//</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                    <td>
                         <table class="table table-borderless">
                            <tbody>
                                <tr ng-repeat="subanswergiven in answergiven.subanswersgiven | byConfidence:confidencefrom:confidenceto | byCorrect:correctfilter | byChecked:checkedbyfilter">
                                    <td>//subanswergiven.read_answer//</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td style="width:300px;">
                       <table class="table table-borderless">
                            <tbody>
                                <tr ng-repeat="subanswergiven in answergiven.subanswersgiven | byConfidence:confidencefrom:confidenceto | byCorrect:correctfilter | byChecked:checkedbyfilter">
                                    <td>
                                        <img width="100%" src="lines/load/line_//subanswergiven.line.id//">
                                    </td>
                                </tr>
                            </tbody>
                       </table>
                    </td>
                    <td style="width:60px;">
                        <table class="table table-borderless">
                                <tbody>
                                    <tr ng-repeat="subanswergiven in answergiven.subanswersgiven | byConfidence:confidencefrom:confidenceto | byCorrect:correctfilter | byChecked:checkedbyfilter">
                                        <td>
                                            <label class="switch"><input type="checkbox" ng-model="subanswergiven.correct" ng-change="vm.updateAnswerCheck(subanswergiven)"><span class="slider round"></span></label>
                                        </td>
                                    </tr>
                                </tbody>
                        </table>
                    </td>
                    <td style="width:100px;">
                        <table class="table table-borderless">
                            <tbody>
                                <tr ng-repeat="subanswergiven in answergiven.subanswersgiven | byConfidence:confidencefrom:confidenceto | byCorrect:correctfilter | byChecked:checkedbyfilter">
                                    <td>
                                        <td>//subanswergiven.confidence//%</td>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td>
                        <table class="table table-borderless">
                            <tbody>
                                <tr ng-repeat="subanswergiven in answergiven.subanswersgiven | byConfidence:confidencefrom:confidenceto | byCorrect:correctfilter | byChecked:checkedbyfilter">
                                    <td>
                                        <td>//subanswergiven.checkedby.personname//</td>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>

        </table>
        <div class="container">
            <button class="btn btn-primary" ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
                Vorige
            </button>
                //currentPage+1// / //vm.numberOfPages()//
            <button class="btn btn-primary" ng-disabled="currentPage >= vm.filteredanswers.length/vm.pageSize - 1" ng-click="currentPage=currentPage+1">
                Volgende
            </button>
        </div>
        <!--
        <div class = 'wrapperhorizontal'>
             <button class = 'btn btn-primary' ng-disabled="pageNum== 0" ng-click="pageNum=pageNum-1">
            Vorige
            </button>
            <label>//pageNum+1// / //numberOfPages()//</label>
            <button class = 'btn btn-primary' ng-disabled="pageNum >= filteredanswers.length/perPage - 1" ng-click="pageNum=pageNum+1">
            Volgende
            </button>
        </div>
        -->
        <div>
            {% if session['logged_in'] == True %}
            <button class="btn btn-primary" ng-click = "vm.deleteAllAnswers()">Verwijder alle antwoorden</button>
            <button class="btn btn-primary" ng-click = "vm.checkAllAnswers()">Kijk antwoorden na</button>
            {% endif %}
        </div>
    </div>
    <div class="alert alert-info" role="alert"  ng-show="vm.checkinganswers">Moment geduld aub.. Antwoorden worden nagekeken ...</div>
</div>
{%endblock%}
</body>
</html>
